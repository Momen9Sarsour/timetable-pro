ضفت حقلين جداد في الاعداد الي هما 
theory_credit_to_slots
practical_credit_to_slots
ويكون الرقم بالساعات يعمري 
بحيث الساعة في الخطة كم تساوي فعليا في الجدول هتكون للنظري والعملي يعمري هذا الي هيقدمو المستخدم عند ضبط الاعدادات الخوارزمية في الفورم 
عشان يكون كبلوك جاهز للتوزيع على الجداول بدلا من كل محاضرة عبارة عن ساعة نخلي في امكانية تكون المحاضرة اكثر من ساعة ويتم التوزيع على هيك 

ونفترض انو المستخدم ادخل يكون الساعة النظري في الجدول = 1 وللعملي = 2 سيكون التوزيع كالتالي يعمري للبلوك 
للجزء النظري =
عدد ساعات النظري في الخطة * عدد الساعات المدخل في الاعدادات في حقل ال theory_credit_to_slots
مثلا اللغة العربية في الخطة 3 ساعات نظري اذن
البلوك هيكون عنا حجمو هيك
للجزء النظري = 3 ضرب 1 = 3 ساعات كبلوك واحد 
او ممكن يكون هيك
للجزء النظري = 2 ساعات (بلوك مزدوج) + 1 ساعات (بلوك ) = 3 ساعات يعني يكون عبارة عن بلوكين
اما
للجزء العملي =
عدد ساعات العملي في الخطة * عدد الساعات المدخل في الاعدادات
مثلا فيزياء عامة عملي في الخطة 1 ساعات عملي اذن
البلوك هيكون عنا حجمو هيك
للجزء العلمي = 1 ضرب 2 = 2 ساعات (بلوك مزدوج )

مثلا رسم هندسي عملي في الخطة 2 ساعات عملي اذن
البلوك هيكون عنا حجمو هيك
للجزء العلمي = 2 ضرب 2 = 4 ساعات (بلوك رباعي الفترة) يعني بلوك يكون مكون من 4 ساعات وهكذا يا عمري 

يعني حجم اللبلوك بكون يعمري بناء على طلب المستخدم ولكن خلي بالك انو البلوك ممكن ينقسم قسمين عادي يعمري يعني يكون في مكانين مختلفين هذا في الجزء النظري يا حياتي اما العملي غالبا ما بنقسم بضلو بلوك واحد كامل يعمري بلوك متعدد الساعات 

فبدنا ايكون حقل ال timeslote_id يقبل اكثر من قيمة يعني يكون عندك ممكن يكون 2 للمادة او اكثر او اقل يعني نقدر نخليه يقبل اكثر من قيمة يعمري 

الحقيقة على أرض الواقع
المحاضرات العملية: هي دائماً بلوك واحد متصل بدون تقسيمها.
المحاضرات النظرية: هي مجموعة من الساعات يمكن توزيعها. مادة 3 ساعات نظري يمكن أن تكون:
بلوك واحد من 3 ساعات.
بلوك من ساعتين + بلوك من ساعة.
3 بلوكات منفصلة، كل بلوك واحد ساعة.

يعني ممكن نعمل مصفوفة نحط فيها كل المواد للشعب وكل مادة كم تحتاج عدد البلوكات ولما ياجي التوزيع يكون اخذ البيانات من هذه المصفوفة بدلا من انو يروح يرجع ياخذ البيانات ثاني من الداتا بيز يعني نجيبهم مرة وحدة ونحطهم في مصفوفة وبعدها نقوم بتمرير هذه المصفوفة لحتى تتوزيع على الجداول 

واهم اشي خلي بالك من توزيع الطلاب الى مجموعات كالمتفق عليه الي هو يعمري زي هيك 

تقوم بتجميع كل الشعب حسب "السياق" (تخصص، مستوى، فصل، فرع).
لكل سياق، تقوم بتحديد عدد مجموعات الطلاب الحقيقية بناءً على المادة التي لديها أكبر عدد من الشعب العملية (بنفس المنطق الذكي الذي اتفقنا عليه).
ثم تقوم بإنشاء "مجموعات طلاب" افتراضية (مجموعة 1، مجموعة 2، إلخ).
أخيراً، تقوم بتعيين كل شعبة (سواء كانت نظرية أو عملية) إلى إحدى هذه المجموعات.
الشعب النظرية في المواد النظري فقط : يتم تعيينها لكل المجموعات (لأنها مشتركة).
الشعب العملية في المواد العملي فقط : يتم توزيعها. الشعبة العملية الأولى من كل مادة تذهب للمجموعة 1، والثانية للمجموعة 2، وهكذا.
وبالنسبة للمواد المشتركة ستكون كالتالي زي ما هو متفق عليه سابقا 
الشعبة النظري : يتم تعيينها لكل المجموعات (لأنها مشتركة).
الشعب العملي : يتم توزيعها. الشعبة العملية الأولى من كل مادة تذهب للمجموعة 1، والثانية للمجموعة 2، وهكذا.

+ 
بدي منك بعد ما نقسم المادة النظري لبلوكات اذا كانت عدد الساعات اكثر من ساعتين يكون المدرس للبلوكين نفس المدرس يعني مش منطق عندي اللغة العربية 3 ساعات مقسمة لجزئين بلوكين ساعتين ثم ساعة بنفعش يكون عندي البلوك الاول بدرسو محمود والبلوك الثاني ياجي ياخذو محمد مش منطق فاهم علي ؟
+
في شغلة لو كنت مدخل مثلا الساعة العملي عبارة عن 3 ساعات فعلية في الجدول بعملها ساعة واحدة فقط ويتجاهل الي احنا مدخلينو في الاعدادات وايضا لو كانت الوقت في الخطة ساعتين وكنت مدخل المحاضرة العملي تكون ساعتين يعني المفروض يكون عندي بلوك واحد يحتوي على 4 فترات يعمري فبدنا نعمل انو يعمل هذي الشغلة لانو الكود السابق ما بعملها وبخليها عبارة عن ساعة واحدة فقط لا غير 
ولكن لما تكون في الخطة عبارة عن ساعة عملي وكنت مدخل في الاعدادات انها الساعة مقابلها ساعتين بعملها بلوك واحد عبارة عن ساعتين ومية المية بتكون ولكن اكثر من ساعة بسير فيها مشاكل وما بتعرف عليها وبختار تكون بلوك واحد ويكون من فترة واحدة فقط وهذا خطا فادح يا حياتي 
+
بدي يعمل فحص قبل اختيار الوقت هل الوقت الي بدي اختارو مشغول ولا لاء اذا مشغول غير الوقت لفترة ثانية لما الاقي وقت لا يوجد فيه تعارض لا مع الطالب ولا المدرس ولا القاعة يعمري واذا عجز عن الحصول على وقت مثالي زي هيك يروح على خيار اقل شوية الي هو يختار فترة للوقت ما تكون عندها تعارض مع الطلاب ولا القاعة ومش مشكلة المدرس  واذا عجز عن الحصول على ذلك البحث عن وقت ما بتعارض مع الطالب ومش مشكلة التعارض مع المدرس او القاعة واذا عجز عن ذلك اختار عشوائي يا حياتي 


اريد منك تعملي هذه التغييرات في الكود واجعله جوده اعلى بحيث نحل كل هذه المشاكل من الكود يا عمري 

****************************************************************************************************

طيب ممتاز عشان في عندي برضو مشكلة في توزيع حجم البلوك في الجوء العملي وما بيأخذ القيم صحيحة وكاملة في حقل timeslot_Ids مما يجعل عدم التوزيع المحاضرات بشكل صحيح كالتالي الشرح المشكلة يعمري انتا : 》الحين شايف الكود هذا عندي مشكلة بسيطة فيه انو لما ياجي يعمل حجم البلوك في الجزء العملي يعني مفروض يعملو حسب الادخال من المستخدم 
الكود الحالي بعمل النظري مزبوط ولكن الجزء العملي اذا كان اكثر من ساعة في الخطة برضاش يعملها وبعمل فقط ساعة واحدة فعليه في الجدول 
مع انو مفروض يخزن القيمة الي في الخطة مضروبة في القيمة المدخلة من المستخدم يعمري 
زي هيك يعمري 
انا ضايف حقلين في الاعداد الي هما 
theory_credit_to_slots
practical_credit_to_slots
ويكون الرقم بالساعات يعمري 
بحيث الساعة في الخطة كم تساوي فعليا في الجدول هتكون للنظري والعملي يعمري هذا الي هيقدمو المستخدم عند ضبط الاعدادات الخوارزمية في الفورم 
عشان يكون كبلوك جاهز للتوزيع على الجداول بدلا من كل محاضرة عبارة عن ساعة نخلي في امكانية تكون المحاضرة اكثر من ساعة ويتم التوزيع على هيك 
ونفترض انو المستخدم ادخل يكون الساعة النظري في الجدول = 1 وللعملي = 2 سيكون التوزيع كالتالي يعمري للبلوك 
للجزء النظري =
عدد ساعات النظري في الخطة * عدد الساعات المدخل في الاعدادات في حقل ال theory_credit_to_slots
مثلا اللغة العربية في الخطة 3 ساعات نظري اذن
البلوك هيكون عنا حجمو هيك
للجزء النظري = 3 ضرب 1 = 3 ساعات كبلوك واحد 
او ممكن يكون هيك
للجزء النظري = 2 ساعات (بلوك مزدوج) + 1 ساعات (بلوك ) = 3 ساعات يعني يكون عبارة عن بلوكين (وهذا الطريقة الي بفضلها لعدم ارهاق المدرسين والطلاب)
اما
للجزء العملي =
عدد ساعات العملي في الخطة * عدد الساعات المدخل في الاعدادات
مثلا فيزياء عامة عملي في الخطة 1 ساعات عملي اذن
البلوك هيكون عنا حجمو هيك
للجزء العلمي = 1 ضرب 2 = 2 ساعات (بلوك واحد مزدوج )
مثلا رسم هندسي عملي في الخطة 2 ساعات عملي اذن
البلوك هيكون عنا حجمو هيك
للجزء العلمي = 2 ضرب 2 = 4 ساعات (بلوك واحد رباعي الفترة) يعني بلوك يكون مكون من 4 ساعات وهكذا يا عمري 
يعني حجم اللبلوك بكون يعمري بناء على طلب المستخدم ولكن خلي بالك انو البلوك ممكن ينقسم قسمين عادي يعمري يعني يكون في مكانين مختلفين هذا في الجزء النظري يا حياتي اما العملي غالبا ما بنقسم بضلو بلوك واحد كامل يعمري بلوك متعدد الساعات 
فبدنا ايكون حقل ال timeslote_ids يقبل اكثر من قيمة يعني يكون عندك ممكن يكون 2 للمادة او اكثر او اقل يعني نقدر نخليه يقبل اكثر من قيمة يعمري 
الحقيقة على أرض الواقع
المحاضرات العملية: هي دائماً بلوك واحد متصل بدون تقسيمها.
المحاضرات النظرية: هي مجموعة من الساعات يمكن توزيعها. مادة 3 ساعات نظري يمكن أن تكون:
بلوك واحد من 3 ساعات.
بلوك من ساعتين + بلوك من ساعة. افضل خطة 
3 بلوكات منفصلة، كل بلوك واحد ساعة.
يعني ممكن نعمل مصفوفة نحط فيها كل المواد للشعب وكل مادة كم تحتاج عدد البلوكات ولما ياجي التوزيع يكون اخذ البيانات من هذه المصفوفة بدلا من انو يروح يرجع ياخذ البيانات ثاني من الداتا بيز يعني نجيبهم مرة وحدة ونحطهم في مصفوفة وبعدها نقوم بتمرير هذه المصفوفة لحتى تتوزيع على الجداول 
واهم اشي خلي بالك من توزيع الطلاب الى مجموعات كالمتفق عليه الي هو يعمري زي هيك 
تقوم بتجميع كل الشعب حسب "السياق" (تخصص، مستوى، فصل، فرع).
لكل سياق، تقوم بتحديد عدد مجموعات الطلاب الحقيقية بناءً على المادة التي لديها أكبر عدد من الشعب العملية (بنفس المنطق الذكي الذي اتفقنا عليه).
ثم تقوم بإنشاء "مجموعات طلاب" افتراضية (مجموعة 1، مجموعة 2، إلخ).
أخيراً، تقوم بتعيين كل شعبة (سواء كانت نظرية أو عملية) إلى إحدى هذه المجموعات.
الشعب النظرية في المواد النظري فقط : يتم تعيينها لكل المجموعات (لأنها مشتركة).
الشعب العملية في المواد العملي فقط : يتم توزيعها. الشعبة العملية الأولى من كل مادة تذهب للمجموعة 1، والثانية للمجموعة 2، وهكذا.
وبالنسبة للمواد المشتركة ستكون كالتالي زي ما هو متفق عليه سابقا 
الشعبة النظري : يتم تعيينها لكل المجموعات (لأنها مشتركة).
الشعب العملي : يتم توزيعها. الشعبة العملية الأولى من كل مادة تذهب للمجموعة 1، والثانية للمجموعة 2، وهكذا.
+ 
بدي منك بعد ما نقسم المادة النظري لبلوكات اذا كانت عدد الساعات اكثر من ساعتين يكون المدرس للبلوكين نفس المدرس يعني مش منطق عندي اللغة العربية 3 ساعات مقسمة لجزئين بلوكين ساعتين ثم ساعة بنفعش يكون عندي البلوك الاول بدرسو محمود والبلوك الثاني ياجي ياخذو محمد مش منطق فاهم علي ؟
+
في شغلة لو كنت مدخل مثلا الساعة العملي عبارة عن 3 ساعات فعلية في الجدول بعملها ساعة واحدة فقط ويتجاهل الي احنا مدخلينو في الاعدادات وايضا لو كانت الوقت في الخطة ساعتين وكنت مدخل المحاضرة العملي تكون ساعتين يعني المفروض يكون عندي بلوك واحد يحتوي على 4 فترات يعمري فبدنا نعمل انو يعمل هذي الشغلة لانو الكود السابق ما بعملها وبخليها عبارة عن ساعة واحدة فقط لا غير 
ولكن لما تكون في الخطة عبارة عن ساعة عملي وكنت مدخل في الاعدادات انها الساعة مقابلها ساعتين بعملها بلوك واحد عبارة عن ساعتين ومية المية بتكون ولكن اكثر من ساعة بسير فيها مشاكل وما بتعرف عليها وبختار تكون بلوك واحد ويكون من فترة واحدة فقط وهذا خطا فادح يا حياتي 
+
بدي يعمل فحص قبل اختيار الوقت هل الوقت الي بدي اختارو مشغول ولا لاء اذا مشغول غير الوقت لفترة ثانية لما الاقي وقت لا يوجد فيه تعارض لا مع الطالب ولا المدرس ولا القاعة يعمري واذا عجز عن الحصول على وقت مثالي زي هيك يروح على خيار اقل شوية الي هو يختار فترة للوقت ما تكون عندها تعارض مع الطلاب ولا القاعة ومش مشكلة المدرس  واذا عجز عن الحصول على ذلك البحث عن وقت ما بتعارض مع الطالب ومش مشكلة التعارض مع المدرس او القاعة واذا عجز عن ذلك اختار عشوائي يا حياتي 
واغلبك اريد الكود ما ياخذ وقت كثير في التنفيذ يعني نسرع في الاداء لاقصى شيء يعمري
اريد منك تعملي هذه التغييرات في الكود واجعله جوده اعلى بحيث نحل كل هذه المشاكل من الكود يا عمري بكامل الدوال يعمري انتا 

الكود الحالي عالج اكم من مشكلة ولكن الباقي لسا قصة البلوكات العملي ضلت زي مهي يعمري بختار اخر خيار وبعملها فقط ساعة واحدة لما يكون عندي اكثر من ساعة في الخطة عملي

وهي الي مفروض يكون معمول يعمري 
+

في العقوبات يعمري في قصة الشعب احنا لما عملنا قصة المجموعات الي هتضم هذه الشعب المتعارف عليهن فاكيد هيكون عندي مثلا شعبة 1 وشعبة 2 في نفس الوقت وهيك طبيعي لانها المادة بتكون مشتركة وبالتالي هذي المفروض ما تكون عليها عقوبة يا حياتي فاهم علي ؟
احنا ممكن نعمل فحص على مستوى المجموعة وليس الشعبة هل بوجد تعارض بين هذه المجموعات ولا لاء اما بالنسبة للشعب فهيكون عنا التعارضات كثيرة وهيه طبيعية وليس تعارض
+ باقي التعارضات الي احنا متفين عليهن برضو ولكن كلو بنفس الالية 

+
حاسس انو في كود بمنع انشاء محاضرة اكثر من فترتين يعني ساعتين متتاليات لنفس المادة سواء نظري ام عملي فهو يمنع هذا الشيء بشكل عام في الكود 
فاحنا نراجع الكود شوي شوي يعمري ايش رايك 
حدد لي وين المشكلة بالظبط يعمري 
